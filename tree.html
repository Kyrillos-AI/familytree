<!DOCTYPE html>
<html lang="ar" dir="rtl" data-theme="light">
  <head>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="theme-color" content="#064e3b" />
    <link rel="icon" href="logo.png" type="image/png" />
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>ุดุฌุฑุฉ ุงูุนุงุฆูุฉ</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/ar.js"></script>
    <script
      type="module"
      src="https://cdn.jsdelivr.net/npm/emoji-picker-element@1/index.js"
    ></script>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="landing.css" />
  </head>
  <body>
    <div id="loader-wrapper">
      <div class="logo-loader-container">
        <div class="logo-glow-ring"></div>
        <img src="logo.png" class="loader-logo-img" alt="Logo" />
        <div class="loading-bar-container">
          <div class="loading-bar-progress"></div>
        </div>
        <div class="loader-status-text">ุฌุงุฑู ูุฒุงููุฉ ุงูุณูุงูุฉ...</div>
      </div>
    </div>
    <div class="bg-glow"></div>

    <div class="main-wrapper">
      <header class="navbar-modern glass">
        <div class="nav-right">
          <div class="nav-brand" onclick="window.showFullTree()">
            <img src="logo.png" class="brand-logo" alt="Logo" />
          </div>
        </div>

        <div class="search-modern-wrapper">
          <div class="search-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <circle cx="11" cy="11" r="8" />
              <path d="m21 21-4.3-4.3" />
            </svg>
          </div>
          <input
            type="text"
            id="search-input"
            placeholder="ุจุญุซ..."
            oninput="window.searchMember()"
          />
          <div id="search-results" class="search-results"></div>
        </div>

        <div class="nav-left-controls">
          <div class="user-profile-wrapper">
            <div class="user-avatar-btn" onclick="window.toggleProfileMenu()">
              <img id="nav-user-img" src="mainmale.png" alt="User" />
              <div class="online-status"></div>
            </div>

            <div id="profile-dropdown" class="profile-dropdown-menu">
              <div class="dropdown-header">
                <span id="dropdown-user-name">ุงุณู ุงููุณุชุฎุฏู</span>
                <small>ูุชุตู ุงูุขู</small>
              </div>
              <hr />
              <button onclick="window.openMyProfileSettings()">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" />
                  <circle cx="12" cy="7" r="4" />
                </svg>
                ูููู ุงูุดุฎุตู
              </button>
              <button onclick="window.toggleTheme()">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path
                    d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"
                  ></path>
                </svg>
                ุงููุถุน ุงููููู
              </button>
              <hr />
              <button class="danger-text" onclick="window.logout()">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                  <polyline points="16 17 21 12 16 7" />
                  <line x1="21" x2="9" y1="12" y2="12" />
                </svg>
                ุชุณุฌูู ุฎุฑูุฌ
              </button>
            </div>
          </div>
          <div class="nav-toggle-btn" onclick="window.toggleNavMenu()">
            <div class="hamburger-icon">
              <span></span>
              <span></span>
              <span></span>
            </div>
          </div>

          <button
            class="nav-icon-btn back-btn"
            onclick="window.goBack()"
            title="ุฑุฌูุน"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="22"
              height="22"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="m15 18-6-6 6-6" />
            </svg>
          </button>
        </div>

        <div id="nav-menu-grid" class="nav-grid-panel">
          <button class="grid-item" onclick="window.showStatsModal()">
            <div class="grid-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path d="M3 3v18h18" />
                <path d="m19 9-5 5-4-4-3 3" />
              </svg>
            </div>
            <span>ุฅุญุตุงุฆูุงุช</span>
          </button>

          <button class="grid-item" onclick="window.openRelCalc()">
            <div class="grid-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
                <circle cx="9" cy="7" r="4" />
                <path d="M22 21v-2a4 4 0 0 0-3-3.87" />
                <path d="M16 3.13a4 4 0 0 1 0 7.75" />
              </svg>
            </div>
            <span>ุงููุฑุงุจุฉ</span>
          </button>

          <button class="grid-item" onclick="window.toggleMaternalRelatives()">
            <div class="grid-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path d="M2 12h10" />
                <path d="M9 4v16" />
                <path d="m3 9 3 3-3 3" />
                <path d="M14 8V6a2 2 0 0 1 2-2h6" />
                <path d="M20 12v-2" />
              </svg>
            </div>
            <span id="maternal-label-grid">ุฃูุงุฑุจ ุงูุฃู</span>
          </button>

          <button class="grid-item" onclick="window.exportTreeImage()">
            <div class="grid-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path
                  d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"
                />
                <circle cx="12" cy="13" r="3" />
              </svg>
            </div>
            <span>ุตูุฑุฉ</span>
          </button>
        </div>
      </header>

      <div class="tree-wrapper">
        <svg id="tree-svg">
          <defs>
            <linearGradient
              id="line-gradient"
              x1="0%"
              y1="0%"
              x2="100%"
              y2="100%"
            >
              <stop
                offset="0%"
                style="stop-color: var(--primary-glow); stop-opacity: 1"
              />
              <stop
                offset="100%"
                style="stop-color: var(--secondary-glow); stop-opacity: 1"
              />
            </linearGradient>
          </defs>
        </svg>
        <div class="tree-container" id="tree-container"></div>
      </div>
    </div>

    <div id="bio-modal" class="modal">
      <div class="modal-content glass">
        <span class="close-btn" onclick="window.closeBio()">&times;</span>

        <div id="view-section">
          <div class="profile-header">
            <div class="image-wrapper">
              <img id="modal-img" src="" alt="ุตูุฑุฉ ุงููุฑุฏ" />
              <div class="image-glow"></div>
            </div>
            <div class="profile-info">
              <h2 id="modal-name"></h2>
              <div id="modal-father" class="profile-subtext"></div>
              <div id="modal-age" class="profile-subtext"></div>
              <div id="extra-info-badges" class="badges-container"></div>
            </div>
          </div>

          <span id="modal-id-display" style="display: none"></span>

          <div
            style="
              display: flex;
              justify-content: flex-end;
              width: 100%;
              padding: 0 10px;
              margin-bottom: 5px;
            "
          >
            <button
              class="btn-mini-mode"
              onclick="window.toggleAppMode()"
              title="ุชุจุฏูู ูุถุน ุงูุชุนุฏูู"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path
                  d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.39a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"
                />
                <circle cx="12" cy="12" r="3" />
              </svg>
            </button>
          </div>

          <div class="modal-row-actions view-controls">
            <button class="action-item" onclick="window.switchProfile()">
              <div class="icon-box primary">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path
                    d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"
                  />
                  <circle cx="12" cy="12" r="3" />
                </svg>
              </div>
              <span>ุนุฑุถ ุงูููู</span>
            </button>
            <button class="action-item" onclick="window.openOccasionModal()">
              <div class="icon-box" style="color: #d63384">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M16 14v2.2l1.6 1" />
                  <path d="M16 2v4" />
                  <path
                    d="M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5"
                  />
                  <path d="M3 10h5" />
                  <path d="M8 2v4" />
                  <circle cx="16" cy="16" r="6" />
                </svg>
              </div>
              <span>ููุงุณุจุฉ</span>
            </button>
            <div class="social-dropdown">
              <button class="action-item">
                <div class="icon-box info">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path
                      d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"
                    />
                    <path
                      d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"
                    />
                  </svg>
                </div>
                <span>ุชูุงุตู</span>
              </button>
              <div class="social-menu"></div>
            </div>
            <button class="action-item" onclick="window.shareMember()">
              <div class="icon-box warning">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <circle cx="18" cy="5" r="3" />
                  <circle cx="6" cy="12" r="3" />
                  <circle cx="18" cy="19" r="3" />
                  <line x1="8.59" x2="15.42" y1="13.51" y2="17.49" />
                  <line x1="15.41" x2="8.59" y1="6.51" y2="10.49" />
                </svg>
              </div>
              <span>ูุดุงุฑูุฉ</span>
            </button>
          </div>

          <div class="modal-row-actions edit-controls" style="display: none">
            <button class="action-item" onclick="window.toggleAddSection(true)">
              <div class="icon-box success">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M2 21a8 8 0 0 1 13.292-6" />
                  <circle cx="10" cy="8" r="5" />
                  <path d="M19 16v6" />
                  <path d="M22 19h-6" />
                </svg>
              </div>
              <span>ุฅุถุงูุฉ</span>
            </button>
            <button
              class="action-item"
              onclick="window.toggleEditSection(true)"
            >
              <div class="icon-box secondary">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M2 21a8 8 0 0 1 10.821-7.487" />
                  <path
                    d="M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z"
                  />
                  <circle cx="10" cy="8" r="5" />
                </svg>
              </div>
              <span>ุชุนุฏูู</span>
            </button>
            <button class="action-item danger" onclick="window.deleteMember()">
              <div class="icon-box danger">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M2 21a8 8 0 0 1 11.873-7" />
                  <circle cx="10" cy="8" r="5" />
                  <path d="m17 17 5 5" />
                  <path d="m22 17-5 5" />
                </svg>
              </div>
              <span>ุญุฐู</span>
            </button>
            <button class="action-item" onclick="window.openOccasionsManager()">
              <div class="icon-box warning" style="color: #ff9f43">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="lucide lucide-calendar-cog-icon lucide-calendar-cog"
                >
                  <path d="m15.228 16.852-.923-.383" />
                  <path d="m15.228 19.148-.923.383" />
                  <path d="M16 2v4" />
                  <path d="m16.47 14.305.382.923" />
                  <path d="m16.852 20.772-.383.924" />
                  <path d="m19.148 15.228.383-.923" />
                  <path d="m19.53 21.696-.382-.924" />
                  <path d="m20.772 16.852.924-.383" />
                  <path d="m20.772 19.148.924.383" />
                  <path
                    d="M21 10.592V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h6"
                  />
                  <path d="M3 10h18" />
                  <path d="M8 2v4" />
                  <circle cx="18" cy="18" r="3" />
                </svg>
              </div>
              <span>ุงูููุงุณุจุงุช</span>
            </button>
          </div>
        </div>

        <div id="add-section" style="display: none">
          <h3 class="modal-title">ุฅุถุงูุฉ ูุฑูุจ ุฌุฏูุฏ</h3>
          <div class="compact-form">
            <div class="flex-row-equal">
              <div class="input-group-icon">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="lucide lucide-user"
                >
                  <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" />
                  <circle cx="12" cy="7" r="4" />
                </svg>
                <input type="text" id="new-name" placeholder="ุงูุงุณู" />
              </div>
              <div class="input-group-icon">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="lucide lucide-calendar"
                >
                  <rect width="18" height="18" x="3" y="4" rx="2" ry="2" />
                  <line x1="16" x2="16" y1="2" y2="6" />
                  <line x1="8" x2="8" y1="2" y2="6" />
                  <line x1="3" x2="21" y1="10" y2="10" />
                </svg>
                <input type="date" id="new-dob" placeholder="ุชุงุฑูุฎ ุงููููุงุฏ" />
              </div>
            </div>
            <div class="flex-row">
              <select id="new-gender" class="mini-input">
                <option value="male">ุฐูุฑ</option>
                <option value="female">ุฃูุซู</option>
              </select>
              <select id="relation-type" class="mini-input">
                <option value="parent">ุฃุจ / ุฃู</option>
                <option value="sibling">ุฃุฎ / ุฃุฎุช</option>
                <option value="spouse">ุฒูุฌ / ุฒูุฌุฉ</option>
                <option value="child">ุงุจู / ุงุจูุฉ</option>
                <option value="uncle_aunt">ุนู / ุนูู</option>
                <option value="maternal_sibling">ุฎุงู / ุฎุงูุฉ</option>
              </select>
            </div>
            <div class="input-group-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="lucide lucide-image"
              >
                <rect width="18" height="18" x="3" y="3" rx="2" ry="2" />
                <circle cx="9" cy="9" r="2" />
                <path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21" />
              </svg>
              <input
                type="text"
                id="new-img"
                placeholder="ุฑุงุจุท ุงูุตูุฑุฉ (ุงุฎุชูุงุฑู)"
              />
            </div>
            <div
              class="input-group-icon"
              style="
                border: 1px solid var(--secondary-glow);
                background: rgba(168, 85, 247, 0.05);
              "
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                class="lucide lucide-link-2"
              >
                <path d="M9 17H7A5 5 0 0 1 7 7h2" />
                <path d="M15 7h2a5 5 0 0 1 0 10h-2" />
                <line x1="8" x2="16" y1="12" y2="12" />
              </svg>
              <select id="new-existing-member">
                <option value="">-- ุฃู ุงุฎุชุฑ ุดุฎุต ููุฌูุฏ ููุฑุจุท --</option>
              </select>
            </div>
            <div class="dynamic-social-container">
              <div id="new-social-list" class="social-list"></div>
              <div class="center-wrapper">
                <button
                  class="btn-add-link-small"
                  onclick="window.addSocialRow('new')"
                >
                  โ ุฅุถุงูุฉ ูุณููุฉ ุชูุงุตู
                </button>
              </div>
            </div>
            <div class="mini-switch-wrapper">
              <label class="switch-small"
                ><input type="checkbox" id="new-hide-main" checked /><span
                  class="slider-small round"
                ></span></label
              ><span>ุฅุฎูุงุก ุชููุงุฆู</span>
            </div>
            <button
              id="new-mark-deceased-btn"
              class="btn-secondary"
              onclick="window.enableDeceasedMode('new')"
              style="
                width: 100%;
                margin: 10px 0;
                border: 1px solid #bdc3c7;
                color: #7f8c8d;
              "
            >
              ุชุณุฌูู ุญุงูุฉ ููุงุฉ ๐ด
            </button>
            <input type="checkbox" id="new-is-deceased" style="display: none" />
            <div
              id="new-death-date-wrapper"
              class="input-group-icon"
              style="
                display: none;
                border-color: #bdc3c7;
                background: rgba(0, 0, 0, 0.05);
              "
            >
              <span style="font-size: 0.9rem; margin-left: 8px"
                >ุชุงุฑูุฎ ุงูููุงุฉ ๐ด:</span
              ><input type="date" id="new-death-date" />
            </div>
          </div>

          <div class="modal-actions-modern flex-row-buttons">
            <button class="btn-confirm" onclick="window.addNewRelative()">
              ุชุฃููุฏ ุงูุฅุถุงูุฉ โ
            </button>
            <button class="btn-cancel" onclick="window.toggleAddSection(false)">
              ุฑุฌูุน โ
            </button>
          </div>
        </div>

        <div id="edit-section" style="display: none">
          <h3 class="modal-title">ุชุนุฏูู ุงูุจูุงูุงุช</h3>
          <div class="compact-form">
            <div class="flex-row">
              <div class="input-group-icon">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="lucide lucide-user-round-icon lucide-user-round"
                >
                  <circle cx="12" cy="8" r="5" />
                  <path d="M20 21a8 8 0 0 0-16 0" />
                </svg>
                <input type="text" id="edit-name" placeholder="ุงูุงุณู ุงููุงูู" />
              </div>
              <div class="input-group-icon">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="lucide lucide-calendar-days"
                >
                  <rect width="18" height="18" x="3" y="4" rx="2" ry="2" />
                  <line x1="16" x2="16" y1="2" y2="6" />
                  <line x1="8" x2="8" y1="2" y2="6" />
                  <line x1="3" x2="21" y1="10" y2="10" />
                  <path d="M8 14h.01" />
                  <path d="M12 14h.01" />
                  <path d="M16 14h.01" />
                  <path d="M8 18h.01" />
                  <path d="M12 18h.01" />
                  <path d="M16 18h.01" />
                </svg>
                <input type="date" id="edit-dob" placeholder="ุชุงุฑูุฎ ุงููููุงุฏ" />
              </div>
            </div>
            <div class="input-group-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="lucide lucide-image-up-icon lucide-image-up"
              >
                <path
                  d="M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10l-3.1-3.1a2 2 0 0 0-2.814.014L6 21"
                />
                <path d="m14 19.5 3-3 3 3" />
                <path d="M17 22v-5.5" />
                <circle cx="9" cy="9" r="2" />
              </svg>
              <input type="text" id="edit-img" placeholder="ุฑุงุจุท ุงูุตูุฑุฉ" />
              <button
                class="btn-reset-img"
                onclick="window.resetPhotoField('edit')"
                title="ุญุฐู ุงูุตูุฑุฉ"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="lucide lucide-trash2-icon lucide-trash-2"
                >
                  <path d="M10 11v6" />
                  <path d="M14 11v6" />
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6" />
                  <path d="M3 6h18" />
                  <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
                </svg>
              </button>
            </div>
            <div class="input-group-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"
                />
                <path
                  d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"
                />
              </svg>
              <select id="edit-existing-spouse">
                <option value="">ุฑุจุท ุจุฒูุฌ/ุฒูุฌุฉ ููุฌูุฏ</option>
              </select>
            </div>
            <div class="dynamic-social-container">
              <div id="edit-social-list" class="social-list"></div>
              <div class="center-wrapper">
                <button
                  class="btn-add-link-small"
                  onclick="window.addSocialRow('edit')"
                >
                  โ ุฅุถุงูุฉ ูุณููุฉ ุชูุงุตู
                </button>
              </div>
            </div>
            <div class="mini-switch-wrapper">
              <label class="switch-small"
                ><input type="checkbox" id="edit-hide-main" /><span
                  class="slider-small round"
                ></span></label
              ><span>ุฅุฎูุงุก ูู ุงูุดุฌุฑุฉ</span>
            </div>
            <button
              id="edit-mark-deceased-btn"
              class="btn-secondary"
              onclick="window.enableDeceasedMode('edit')"
              style="
                width: 100%;
                margin: 10px 0;
                border: 1px solid #bdc3c7;
                color: #7f8c8d;
              "
            >
              ุชุณุฌูู ุญุงูุฉ ููุงุฉ ๐ด
            </button>
            <input
              type="checkbox"
              id="edit-is-deceased"
              style="display: none"
            />
            <div
              id="edit-death-date-wrapper"
              class="input-group-icon"
              style="
                display: none;
                border-color: #bdc3c7;
                background: rgba(0, 0, 0, 0.05);
              "
            >
              <span style="font-size: 0.9rem; margin-left: 8px"
                >ุชุงุฑูุฎ ุงูููุงุฉ ๐ด:</span
              ><input type="date" id="edit-death-date" />
            </div>
            <button
              id="break-engagement-btn"
              class="btn-danger"
              onclick="window.breakEngagement()"
              style="
                width: 100%;
                margin-top: 15px;
                display: none;
                border: 1px solid #ff4757;
                background: rgba(255, 71, 87, 0.1);
                color: #ff4757;
              "
            >
              ๐ ูุณุฎ ุงูุฎุทูุจุฉ
            </button>
            <button
              id="break-marriage-btn"
              class="btn-danger"
              onclick="window.breakMarriage()"
              style="
                width: 100%;
                margin-top: 15px;
                display: none;
                border: 1px solid #000;
                background: rgba(0, 0, 0, 0.1);
                color: #333;
              "
            >
              ๐ ุฅููุงุก ุงูุฒูุงุฌ / ุทูุงู
            </button>
          </div>
          <div class="modal-actions-modern flex-row-buttons">
            <button class="btn-confirm" onclick="window.saveEdit()">
              ุญูุธ โ
            </button>
            <button
              class="btn-cancel"
              onclick="window.toggleEditSection(false)"
            >
              ุฅูุบุงุก โ
            </button>
          </div>
        </div>

        <div id="occasions-manager-section" style="display: none">
          <h3 class="modal-title">๐ ุฅุฏุงุฑุฉ ุงูููุงุณุจุงุช</h3>
          <div id="manage-occasions-list" class="compact-form"></div>
          <div class="modal-actions-modern" style="margin-top: 20px">
            <button class="btn-cancel" onclick="window.closeOccasionsManager()">
              ุฑุฌูุน ๐
            </button>
          </div>
        </div>
      </div>
    </div>
    <div id="rel-calc-modal" class="modal">
      <div class="modal-content glass" style="max-width: 500px">
        <span
          class="close-btn"
          onclick="document.getElementById('rel-calc-modal').style.display='none'"
          >&times;</span
        >
        <h3 class="modal-title">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#00ff91"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="lucide lucide-users-round-icon lucide-users-round"
          >
            <path d="M18 21a8 8 0 0 0-16 0" />
            <circle cx="10" cy="8" r="5" />
            <path d="M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3" />
          </svg>
          <br />
          ูุงุดู ุตูุฉ ุงููุฑุงุจุฉ
        </h3>

        <div class="compact-form">
          <div class="calc-main-row">
            <div class="search-wrapper-modal">
              <input
                type="text"
                id="input-person-b"
                placeholder="ุงูุดุฎุต ุงูุฃูู..."
                oninput="window.searchForCalc('b')"
              />
              <div id="results-person-b" class="modal-search-results"></div>
              <input type="hidden" id="id-person-b" />
            </div>
            <div class="calc-label">ู/ุชูุฑุจ ูู</div>
            <div class="search-wrapper-modal">
              <input
                type="text"
                id="input-person-a"
                placeholder="ุงูุดุฎุต ุงูุซุงูู..."
                oninput="window.searchForCalc('a')"
              />
              <div id="results-person-a" class="modal-search-results"></div>
              <input type="hidden" id="id-person-a" />
            </div>
          </div>

          <div class="center-wrapper">
            <button
              class="btn-swap-calc"
              onclick="window.swapCalcPersons()"
              title="ุชุจุฏูู ุงูุฃูุงูู"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="lucide lucide-arrow-left-right"
              >
                <path d="M8 3 4 7l4 4" />
                <path d="M4 7h16" />
                <path d="m16 21 4-4-4-4" />
                <path d="M20 17H4" />
              </svg>
            </button>
          </div>

          <div
            id="rel-result-box"
            class="rel-result-centered"
            style="display: none"
          >
            <p id="rel-result-text"></p>
          </div>
        </div>

        <div class="modal-actions-modern" style="margin-top: 15px">
          <button class="btn-confirm" onclick="window.calculateRelationship()">
            ๐ฎูุดู ุงููุฑุงุจู๐ฎ
          </button>
        </div>
      </div>
    </div>
    <div id="custom-alert-overlay" class="alert-overlay">
      <div class="custom-alert glass">
        <div class="alert-icon">โ๏ธ</div>
        <p id="custom-alert-message"></p>
        <button class="btn-confirm" onclick="window.closeCustomAlert()">
          ูููุช โ
        </button>
      </div>
    </div>
    <div id="custom-confirm-overlay" class="alert-overlay">
      <div class="custom-alert glass">
        <div class="alert-icon">๐๏ธ</div>
        <p id="custom-confirm-message">ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงููุฑุฏุ</p>
        <div class="modal-actions-modern">
          <button class="btn-confirm" id="confirm-yes">ูุนูุ ุงุญุฐู ๐๏ธ</button>
          <button class="btn-cancel" onclick="window.closeCustomConfirm()">
            ุฅูุบุงุก โ
          </button>
        </div>
      </div>
    </div>
    <script type="module" src="script.js"></script>
    <div id="occasion-modal" class="modal">
      <div class="modal-content glass" style="max-width: 400px">
        <span
          class="close-btn"
          onclick="window.closeModalSmoothly('occasion-modal')"
          >&times;</span
        >

        <h3 class="modal-title" style="color: #d63384">
          ๐ ุฅุถุงูุฉ ููุงุณุจุฉ ุฌุฏูุฏุฉ
        </h3>

        <div class="compact-form">
          <div class="input-group-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path
                d="M12 21.6a9.2 9.2 0 0 1-6.4-15.6l.8-.8a9.2 9.2 0 0 1 15.6 6.4v.8"
              />
            </svg>
            <select id="occasion-type" onchange="window.updateOccasionUI()">
              <option value="" disabled selected>
                -- ุงุฎุชุฑ ููุน ุงูููุงุณุจุฉ ุฃููุงู --
              </option>
              <option value="engagement">๐ ุฎุทูุจุฉ</option>
              <option value="marriage">๐ฐ๐คต ุฒูุงุฌ (ูุชุจ ูุชุงุจ)</option>
            </select>
          </div>

          <div class="input-group-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <rect width="18" height="18" x="3" y="4" rx="2" ry="2" />
              <line x1="16" x2="16" y1="2" y2="6" />
              <line x1="8" x2="8" y1="2" y2="6" />
              <line x1="3" x2="21" y1="10" y2="10" />
            </svg>
            <input
              type="date"
              id="occasion-date"
              placeholder="ุชุงุฑูุฎ ุงูููุงุณุจุฉ"
            />
          </div>

          <div
            id="partner-source-toggle"
            class="tech-radio-group"
            style="display: none"
          >
            <label class="tech-radio-label">
              <input
                type="radio"
                name="partner-source"
                value="existing"
                checked
                onchange="window.updateOccasionUI()"
              />
              <div class="tech-radio-content">
                <span class="radio-dot"></span>
                <span>ูู ุงูุนุงุฆูุฉ</span>
              </div>
            </label>

            <label class="tech-radio-label">
              <input
                type="radio"
                name="partner-source"
                value="new"
                onchange="window.updateOccasionUI()"
              />
              <div class="tech-radio-content">
                <span class="radio-dot"></span>
                <span>ุดุฎุต ุฌุฏูุฏ</span>
              </div>
            </label>
          </div>

          <div
            class="input-group-icon"
            id="partner-select-wrapper"
            style="display: none"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <circle cx="11" cy="11" r="8" />
              <path d="m21 21-4.3-4.3" />
            </svg>
            <div class="search-wrapper-modal" style="width: 100%">
              <input
                type="text"
                id="occasion-partner-input"
                placeholder="ุงุจุญุซ ุนู ุงูุงุณู ูู ุงูุดุฌุฑุฉ..."
                oninput="window.searchForOccasionPartner()"
              />
              <div
                id="occasion-partner-results"
                class="modal-search-results"
              ></div>
              <input type="hidden" id="occasion-partner-id" />
            </div>
          </div>

          <div
            class="input-group-icon"
            id="new-partner-wrapper"
            style="display: none"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
              <circle cx="8.5" cy="7" r="4" />
              <line x1="20" x2="20" y1="8" y2="14" />
              <line x1="23" x2="17" y1="11" y2="11" />
            </svg>
            <input
              type="text"
              id="occasion-new-partner-name"
              placeholder="ุงุณู ุงูุฒูุฌ/ุงูุฒูุฌุฉ ุงูุฌุฏูุฏ..."
            />
          </div>
        </div>

        <div class="modal-actions-modern" style="margin-top: 20px">
          <button
            class="btn-confirm"
            onclick="window.saveOccasion()"
            style="background: linear-gradient(135deg, #d63384, #e84393)"
          >
            ุชุฃููุฏ ูุญูุธ ๐
          </button>
        </div>
      </div>
    </div>
    <button
      id="tutorial-btn"
      onclick="window.startTour()"
      title="ุฏููู ุงูุงุณุชุฎุฏุงู"
    >
      <span class="pulse-ring"></span>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <circle cx="12" cy="12" r="10" />
        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" />
        <path d="M12 17h.01" />
      </svg>
    </button>
    <div id="logout-confirm-overlay" class="alert-overlay">
      <div class="custom-alert glass">
        <div class="alert-icon" style="font-size: 3rem">๐</div>
        <h3 style="color: var(--text-main); margin: 10px 0">ุชุณุฌูู ุงูุฎุฑูุฌุ</h3>
        <p style="opacity: 0.8; margin-bottom: 20px">
          ูุชูุญุดูุง! ูุชุฃูุฏ ุฅูู ุนุงูุฒ ุชุฎุฑุฌ ูู ุงูุนุงุฆูุฉุ
        </p>

        <div class="modal-actions-modern flex-row-buttons">
          <button
            class="btn-confirm"
            onclick="window.performLogout()"
            style="background: #ff4757"
          >
            ูุนูุ ุฎุฑูุฌ
          </button>
          <button class="btn-cancel" onclick="window.closeLogoutModal()">
            ุฎููู ููุงูู
          </button>
        </div>
      </div>
    </div>

    <div id="google-alert-overlay" class="alert-overlay">
      <div
        class="custom-alert glass"
        style="border-top: 4px solid var(--primary-glow)"
      >
        <div class="alert-icon">๐</div>
        <p
          id="google-alert-message"
          style="font-weight: bold; font-size: 1rem"
        ></p>
        <button
          class="btn-confirm"
          onclick="window.closeGoogleAlert()"
          style="width: 100%; margin-top: 10px"
        >
          ุญุณูุงู
        </button>
      </div>
    </div>
    <div id="tour-overlay">
      <div id="tour-highlight-box"></div>
      <div id="tour-tooltip">
        <h3 id="tour-title">ุนููุงู ุงูุฎุทูุฉ</h3>
        <p id="tour-desc">ุดุฑุญ ุงูุฎุทูุฉ ููุง...</p>
        <div class="tour-controls">
          <span id="tour-step-count">1 / 5</span>
          <div style="display: flex; gap: 10px">
            <button onclick="window.endTour()" class="btn-tour-skip">
              ุฎุฑูุฌ
            </button>
            <button onclick="window.nextTourStep()" class="btn-tour-next">
              ุงูุชุงูู โฏ
            </button>
          </div>
        </div>
      </div>
    </div>
    <button id="chat-toggle-btn" onclick="window.toggleChatPanel()">
      <span class="notification-dot" style="display: none"></span>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="32"
        height="32"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path
          d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"
        ></path>
      </svg>
    </button>

    <div id="chat-panel" class="glass-chat-panel">
      <div class="chat-header">
        <img src="ูุตููููู.png" alt="Waslaa" class="chat-header-logo" />
        <div class="header-controls">
          <button class="close-chat" onclick="window.toggleChatPanel()">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
      </div>

      <div id="global-messages" class="chat-messages-area"></div>

      <div class="chat-input-area">
        <button class="emoji-btn" onclick="window.toggleEmojiPicker()">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="lucide lucide-smile-plus-icon lucide-smile-plus"
          >
            <path d="M22 11v1a10 10 0 1 1-9-10" />
            <path d="M8 14s1.5 2 4 2 4-2 4-2" />
            <line x1="9" x2="9.01" y1="9" y2="9" />
            <line x1="15" x2="15.01" y1="9" y2="9" />
            <path d="M16 5h6" />
            <path d="M19 2v6" />
          </svg>
        </button>

        <input
          type="text"
          id="global-input"
          placeholder="ุงูุชุจ ุฑุณุงูุฉ ููุนุงุฆูุฉ..."
          onkeypress="window.handleEnter(event)"
        />

        <button class="send-btn" onclick="window.sendMessage()">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="feather feather-send"
          >
            <line x1="22" y1="2" x2="11" y2="13"></line>
            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
          </svg>
        </button>
      </div>

      <div id="emoji-popup" class="emoji-popup">
        <emoji-picker></emoji-picker>
      </div>
    </div>
    <div
      id="global-search-modal"
      class="alert-overlay hidden"
      style="
        display: none;
        position: fixed;
        z-index: 2000;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        align-items: center;
        justify-content: center;
      "
    >
      <div
        class="glass-login-card"
        style="
          width: 90%;
          max-width: 500px;
          height: 80vh;
          display: flex;
          flex-direction: column;
        "
      >
        <div class="card-header">
          <h3>๐ ุจุญุซ ูู ูู ุงูุนุงุฆูุงุช</h3>
          <p>ุงุจุญุซ ุนู ุดุฑูู ุฃู ูุฑูุจ ูู ุงูุฃุดุฌุงุฑ ุงูุฃุฎุฑู</p>
        </div>

        <div class="custom-input-group">
          <span class="input-icon">๐</span>
          <input
            type="text"
            id="global-search-input"
            placeholder="ุงูุชุจ ุงูุงุณู ููุจุญุซ..."
            onkeyup="handleGlobalSearch(this.value)"
          />
        </div>

        <div
          id="global-results-container"
          style="flex: 1; overflow-y: auto; margin-top: 15px; text-align: right"
        >
          <div style="color: #aaa; text-align: center; margin-top: 20px">
            ุงุจุฏุฃ ุงููุชุงุจุฉ ููุจุญุซ...
          </div>
        </div>

        <button
          class="text-btn"
          onclick="closeGlobalSearch()"
          style="margin-top: 10px"
        >
          ุฅุบูุงู
        </button>
      </div>
    </div>

    <button
      onclick="window.openGlobalSearch()"
      style="
        position: fixed;
        top: 20px;
        left: 20px;
        z-index: 9999; /* ๐ ุฑูู ุนุงูู ุฌุฏุงู ุนุดุงู ูุธูุฑ ููู ูู ุญุงุฌุฉ */
        background: rgba(255, 255, 255, 0.15);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: white;
        padding: 12px;
        border-radius: 50%;
        cursor: pointer;
        backdrop-filter: blur(10px);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        transition: transform 0.2s;
      "
      onmouseover="this.style.transform='scale(1.1)'"
      onmouseout="this.style.transform='scale(1)'"
    >
      ๐
    </button>
  </body>
</html>
